%% SCUDEM PROBLEM 3 CODE
% Lily, Zifan, James

%%%%%%%%%%%%%%%%%
% Predator/Prey Model
%%%%%%%%%%%%%%%%%

% Variables
% B = Butterfly (t)
% W = Wasp (t)


% Parameters
% a1 == reproductive rate : (eggs/time * pheromone)
% d1 == rate at which predator and prey meet : (k * pheromone)
% a2 == growth rate of predator population (porportional to 
% d2 ==

% Equations:
% dB/dt = a1 B(t) - d1 B(t) W(t)
% dW/dt = a2

% Parameter values:
a1 = 1.1-0.4;
a2 = 0.1-0.4
b = 0.0001;
k = 1/100;

% Time variable
Tmax = 100;
deltaT = 0.01;
time = (0:deltaT:Tmax);
Nt = length(time);

% Allocate space
S = zeros(Nt,1);
I = zeros(Nt,1);

% Initial conditions
S(1) = 10;
I(1) = S(1);

% Implement Euler's scheme
for it = 2:Nt
    t = time(it);
    % First order update
    S(it) = S(it-1) + (a1*S(it-1)- (b*S(it-1)*I(it-1)))*deltaT;
    I(it) = I(it-1) + (b*S(it-1)*I(it-1) +a2 *I(it-1))*deltaT;
end


% Visualize solution
plot(time,S,'b',time,I,'r')
xlabel('time')
legend('Prey','Predator')

% Collect statistics
% Max Infected time
[InfectMax, imax] = max(I);
tMaxInfected = time(imax);

% Report results
fprintf(1,'Max Outbreak at t=%f , Infected = %f\n',tMaxInfected,InfectMax);
